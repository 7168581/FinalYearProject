<%- include header %>

<form class="form-horizontal" method="post">
<fieldset>
	<legend><h1><%= title %></h1></legend>
	<div class="col-md-8 col-md-offset-2">
		<div class="scroll-area" data-spy="scroll" data-offset="0">
			<table class="table table-hover table-bordered">
				<% users.forEach(function (user, index) { %>
					<tr>
						<td>
							<div class="row">
								<div class="col-md-8">
									<h4>
										User Name: 
										<a href="#">
											<%= user.name %>
										</a>
										<small>
											User Type: <%= user.userType %>
										</small>
									</h4>
								</div>
								<div class="col-md-4">
								<% if(user.name != "admin") { %>
									<div class="pull-right">
										<input type="checkbox">
										<a class="edit" href="/permission/<%= user.name %>">Edit</a>
									<a class="delete" href="#delete_user_modal" data-toggle="modal" onclick="delete_user_function('<%= user.userId %>', '<%= user.name %>')">Delete</a>
									</div>
								<% } %>
								</div>
							</div>
						</td>
					</tr>
				<% }) %>
			</table>
		</div>
	</div>
</fieldset>
</form>

<div class="modal fade" id="delete_user_modal" tabindex="-1" role="dialog" aria-labelledby="deleteLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
				<h3>Confirm Delete</h3>
			</div>
			<div class="modal-body">
				<p id="modalP">Are you sure you want to delete this user?</p>
			</div>
			<div class="modal-footer">
				<a class="btn" data-dismiss="modal">Cancel</a>
				<a class="btn btn-primary" name="delete-btn" id="delete_confirm_btn">Delete</a>
			</div>
		</div>
	</div>
</div>


<script>
var user_id;
var user_name;
$(document).ready(function(){
	$("#delete_confirm_btn").click(function(){
		var url = "/delete-user/" + user_name + "/" + user_id;
		window.location.href=url;
	});
});

function delete_user_function(userId, userName){
	user_id = userId;
	user_name = userName;
	$("#modalP").text("Are you sure you want to delete \"" + userName + "\"?");
}
</script>

<%- include footer %>