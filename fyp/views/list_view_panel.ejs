<% if (user.userType == "admin") { %>
	<div class="col-md-3 col-md-offset-1">
		<div class="scroll-area" data-spy="scroll" data-target=".scroll-area" data-offset="0">
			<div class="panel-group" id="accordion">
			<% lists.forEach(function (list, index) { %>
				<div class="panel panel-default">
					<div class="panel-heading">
						<h3 class="panel-title">
							<a href="#panel_<%= list.listId %>" data-toggle="collapse" data-parent="#accordion">
								<%= list.listName %>
							</a>
							<% if (user.userType == "admin") { %>
								<div class="pull-right">
									<a class="view" href="#">View</a>
									<a class="edit" href="/edit-list/<%= list.listId %>">Edit</a>
									<a class="delete" href="#delete_list_modal" data-toggle="modal" onclick="delete_list_function('<%= list.listId %>', '<%= list.listName %>')" id="delete_list">Delete</a>
								</div>
							<% } %>
						</h3>
						<div class="modal fade" id="delete_list_modal" tabindex="-1" role="dialog" aria-labelledby="deleteLabel" aria-hidden="true">
							<div class="modal-dialog">
								<div class="modal-content">
									<div class="modal-header">
										<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
										<h3>Comfirm Delete</h3>
									</div>
									<div class="modal-body">
										<p id="delete_list_text">Are you sure you want to delete this list</p>
									</div>
									<div class="modal-footer">
										<a class="btn" data-dismiss="modal">Cancel</a>
										<a class="btn btn-primary" name="delete-btn" id="delete_list_confirm_btn">Delete</a>
									</div>
								</div>
							</div>
						</div>
					</div>
					<div class="panel-collapse collapse" id="panel_<%= list.listId %>">
						<div class="panel-body">
							<p class="text-muted">
								<strong>list ID:</strong> <%= list.listId %>
							</p>
							<p class="text-muted">
								<strong>User name:</strong> <a href="#"><%= list.userName %></a>
							</p>
							<p class="text-muted">
								<strong>User id:</strong> <%= list.userId %>
							</p>
							<p class="text-muted">
								<strong>Rate: <div class="rateit"  id="rateit3" data-rateit-value="<%= list.rate %>" data-rateit-ispreset="true" data-rateit-readonly="true"></div></strong>
							</p>
							<p><strong>Description:</strong></p>
							<p><%= list.info %></p>
						</div>
					</div>
				</div>
			<% }) %>
<script>
var list_id;
$(document).ready(function(){
	$(".panel-collapse").first().collapse('show');
	
	$("#create_list_confirm_btn").click(function(){
	var url = "/add-list",
		listName = $("#listName").val(),
		info = $("#info").val();
		
	$.post(url,{listName: listName, info: info, webpage: 1},function(data){
			if(data.status == 1){
				alert("List already exist");
			}
			console.log(data.status);
			if(data.status == 2){
				window.location.href="/";
				//$("#cancel_create").click();
			}
	});
	});
});

function delete_list_function(listId, listName){
	list_id = listId;
	$("#delete_list_text").text("Are you sure you want to delete \"" +listName + "\"?");
}

$("#delete_list_confirm_btn").click(function(){
	var url = "/delete-list/" + list_id;
	window.location.href=url;
});

$('#accordion .rateit').bind('rated', function(event, value) {
	var ri = $(this);
	var rate_value = value;
	var rated_itemId = ri.data('id');
	
	var url_1 = "/add-rate";
/***
	$.post(url_1,{rating: rate_value, itemId: rated_itemId},function(){
			console.log('value saved as' + value);
	});
***/
});

$("#accordion .rateit").bind('over', function (event,value) { $(this).attr('title', value); });

</script>
			</div>
		</div>
		<div class="col-md-6 col-md-offset-3">
			<ul class="pagination">
			  <li class="disabled"><a href="#">&laquo;</a></li>
			  <li><a href="#">&raquo;</a></li>
			</ul>
		</div>
	</div>
	
<div class="modal fade" id="create_list_modal" tabindex="-1" role="dialog" aria-labelledby="deleteLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
				<h3>Create a list</h3>
			</div>
			<div class="modal-body">
				<div class="form-group">
					<div class="row">
						<div class="col-md-3">
							<label class="control-label" for="itemName">List name</label>
						</div>
						<div class="col-md-8">
							<input type="text" class="form-control" id="listName" autofocus="autofocus" required="required" maxlength="25" placeholder="List name">
						</div>
					</div>
				</div>
				<div class="form-group">
					<div class="row">
						<div class="col-md-3">
							<label class="control-label" for="info">List Information</label>
						</div>
						<div class="col-md-8">
							<textarea class="form-control" id="info" name="info" row="8" placeholder="Some info here"></textarea>
						</div>
					</div>
				</div>
			</div>
			<div class="modal-footer">
				<a class="btn" data-dismiss="modal" id="cancel_create">Cancel</a>
				<a class="btn btn-primary" id="create_list_confirm_btn">Create!</a>
			</div>
		</div>
	</div>
</div>
<% } %>